off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_pairs_fixed.jpeg")),width=10,height=10)
p <- mcmc_pairs(fit,pars = c("b_tdd_5","b_tdd_9","b_tdd_14","b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"),
off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_pairs_fixed.jpeg")),width=10,height=10)
p <- mcmc_pairs(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"),
off_diag_args = list(size = .5, alpha = 0.5))
if(!debug_model) ggsave(filename=path(model_dir,glue("{prefix}_sigma_pairs.jpeg")),width=10,height=10)
p <- mcmc_pairs(fit,pars = c("b_0","b_w","b_h","b_td"),
off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_pairs_noTDD_fixed.jpeg")),width=10,height=10)
p <- mcmc_pairs(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"),
off_diag_args = list(size = .5, alpha = 0.5))
if(!debug_model) ggsave(filename=path(model_dir,glue("{prefix}_sigma_pairs.jpeg")),width=10,height=10)
summary(fit)
p <- mcmc_pairs(fit,regex_pars="sigma",
off_diag_args = list(size = .5, alpha = 0.5))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_pairs.jpeg")),width=10,height=10)
mcmc_trace(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"))
if(!debug_model) ggsave(filename=path(model_dir,glue("{prefix}_sigma_trace.jpeg")),width=7,height=6)
# setup ==============================================================
rm(list=ls())
library(tidyverse)
library(glue)
library(ggsci)
library(tidybayes)
library(fs)
library(rstan)
library(posterior)
library(bayesplot)
library(here)
library(patchwork)
options(digits=5)
read_dat <- function(f){
dd <- read_csv(f) %>%
mutate(display=recode(display, spektor="triangle", trueblood="horizontal"),
across(c(sub_n,tdo,display,choice),as.factor),
display=fct_relevel(display,c("triangle","horizontal")))
return(dd)
}
d <- here("exp1b","data","aggregated","rect_exp1b_aggregated.csv") %>%
read_dat()
# number of ppts
get_subs <- function(d){
p <- length(unique(d$sub_n))
print(p)
return(p)
}
n_subs <- get_subs(d)
# separate data by catch/critical
catch <- d %>%
filter(trial=="catch") %>%
select(-c(tdd,tdo,tw,th,cw,ch,dw,dh,ta,ca,da,probe)) %>%
mutate(correct=case_when(
choice=="l"~1,
choice %in% c("sw","sh")~0
))
critical <- d %>%
filter(trial=="critical")
# checking props on all critical trials ========================================================================================
critical_mean_props_all <- critical %>%
mutate(tdd=as.factor(tdd),
probe=as.factor(probe)) %>%
group_by(sub_n,tdd,probe,choice) %>%
summarise(N=n()) %>%
group_by(sub_n,tdd,probe) %>%
mutate(prop=N/sum(N)) %>%
ungroup() %>%
group_by(tdd,probe,choice) %>%
summarise(m=mean(prop),
s=sd(prop),
N=n(),
se=s/sqrt(N),
ci_lower=m-qt(.975,n()-1)*se,
ci_upper=m+qt(.975,n()-1)*se) %>%
ungroup()
critical_mean_props_all
critical_mean_props_all %>%
ggplot(aes(tdd,m,col=choice,group=choice))+
geom_point()+
geom_errorbar(aes(ymin=ci_lower,ymax=ci_upper),width=.2)+
geom_line()+
scale_y_continuous(limits=c(0,1),breaks=seq(0,1,.2))+
facet_grid(probe~.)+
ggthemes::theme_few()
# critical TD trial analyses ========================================================================================
# baseline display level should be triangle for model
critical_1 <- critical %>%
filter(tdd!=0 & probe!="tc") %>%
mutate(tdd=as.factor(tdd),
probe=factor(probe,levels=c("dc","td"))) %>%
mutate(display=fct_relevel(display,c("triangle","horizontal")),
discrim=case_when(
choice=="t" & probe=="td"~1,
choice=="c" & probe=="dc"~1,
choice=="d"~0
)) %>%
arrange(sub_n,trial_number)
critical_mean_discrim <- critical_1 %>%
group_by(sub_n,tdd,probe,display) %>%
summarise(p_discrim=mean(discrim)) %>%
group_by(tdd, probe, display) %>%
summarise(mean_discrim=mean(p_discrim),
se=sd(p_discrim)/sqrt(n()),
ci_lower=mean_discrim-qt(.975,n()-1)*se,
ci_upper=mean_discrim+qt(.975,n()-1)*se) %>%
ungroup() %>%
mutate(tdd=as.numeric(as.character(tdd))*100)
critical_mean_discrim %>%
ggplot(aes(tdd, mean_discrim,col=probe))+
geom_point(alpha=.8)+
geom_line(alpha=.8)+
geom_errorbar(aes(ymin=ci_lower,ymax=ci_upper),width=.75,alpha=.8)+
facet_grid(.~display)+
scale_x_continuous(breaks=c(2,5,9,14))+
scale_y_continuous(limits=c(.5,1))+
ggsci::scale_color_startrek(name="choice")+
labs(x="target-decoy distance",y="proability discriminate")+
ggthemes::theme_few()+
theme(text=element_text(size=18),
plot.title=element_text(hjust=0.5),
legend.position = "inside",
legend.position.inside = c(.1,.85))
ggsave(filename=here("analyses","plots","critical_discrim_CIs.jpeg"),width=6,height=5)
# Critical TD trials - Statistical modeling ========================================================================
subs_key <- tibble(
sub_n = sort(unique(critical_1$sub_n)),
sub_n_new = seq(1,n_subs,1)
)
critical_for_model <- tibble(
sub_n=critical_1$sub_n,
trial_number=critical_1$trial_number,
tdo=if_else(critical_1$tdo=="w",1,0),
display=if_else(critical_1$display=="horizontal",1,0),
probe=if_else(critical_1$probe=="td",1,0),
tdd_5=if_else(critical_1$tdd==0.05,1,0),
tdd_9=if_else(critical_1$tdd==0.09,1,0),
tdd_14=if_else(critical_1$tdd==0.14,1,0),
discrim=critical_1$discrim
) %>%
left_join(subs_key) %>% ## assigning "new" subject numbers. Just going sequentially from 1-n subs for easier indexing in stan
relocate(sub_n_new,.after=sub_n)
critical_unique <- critical_for_model %>%
distinct(sub_n_new,tdo,display,probe,tdd_5,tdd_9,tdd_14)
n_unique <- nrow(critical_unique)
stan_data <- list(
n_subs=n_subs,
n_trials=nrow(critical_for_model),
sub_n_new=critical_for_model$sub_n_new,
tdo=critical_for_model$tdo,
display=critical_for_model$display,
probe=critical_for_model$probe,
tdd_5=critical_for_model$tdd_5,
tdd_9=critical_for_model$tdd_9,
tdd_14=critical_for_model$tdd_14,
discrim=critical_for_model$discrim,
n_trials_unique=n_unique,
sub_n_new_unique=critical_unique$sub_n_new,
tdo_unique=critical_unique$tdo,
display_unique=critical_unique$display,
probe_unique=critical_unique$probe,
tdd_5_unique=critical_unique$tdd_5,
tdd_9_unique=critical_unique$tdd_9,
tdd_14_unique=critical_unique$tdd_14
)
# controls
debug_model <- F
prefix <- "m2"
model_dir <- path(here("analyses","stan",prefix))
stan_model_code <- path(model_dir,glue("{prefix}.stan"))
fit_file <- path(model_dir,glue("{prefix}_fit.RData"))
if(debug_model){
n_iter <- 100
n_core <- 1
n_chain <- 2
n_warm <- 10
to_save <- F
}else{
# number of iterations for each model per core (for MCMC)
n_iter <- 6000
n_chain <- 4
n_core <- 10
}
if(!file_exists(fit_file) | debug_model){
model_compiled <- stan_model(stan_model_code)
fit <- sampling(model_compiled,
data=stan_data,
chains=n_chain,
cores=n_core,
iter=n_iter)
if(!debug_model) save(fit,file=fit_file)
fit_summary <- summary(fit,probs=c(.025,.975))
if(!debug_model) save(summary, file=path(model_dir,glue("{prefix}_summary.RData")))
diagnostics <- get_sampler_params(fit)
if(!debug_model) save(diagnostics, file=path(model_dir,glue("{prefix}_diag.RData")))
}else{
load(fit_file)
}
# check modeling ===============================================================================
# m_fit <- as.matrix(fit)
color_scheme_set("red")
try({
p <- mcmc_trace(fit,c("lp__"))
if(!debug_model) ggsave(p, filename=path(model_dir,glue("{prefix}_lp___trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_0"))
if(!debug_model) ggsave(p, filename=path(model_dir,glue("{prefix}_b_0_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_tdd_5","b_tdd_9","b_tdd_14"))
if(!debug_model) ggsave(p, filename=path(model_dir,glue("{prefix}_b_tdd_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_td"))
if(!debug_model) ggsave(p, filename=path(model_dir,glue("{prefix}_b_td_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_w"))
if(!debug_model) ggsave(p, filename=path(model_dir,glue("{prefix}_b_w_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_h"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_h_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_X_td_trace.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_trace(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_trace.jpeg")),width=7,height=6)
rm(p)
})
try({
p <- mcmc_hist(fit,c("lp__"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_lp___hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_0"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_0_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_tdd_5","b_tdd_9","b_tdd_14"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_td_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_w"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_w_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_h"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_h_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_X_td_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_hist(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_hist.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("lp__"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_lp___dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_0"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_0_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_tdd_5","b_tdd_9","b_tdd_14"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_td_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_w"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_w_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_h"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_h_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_X_td_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_dens.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("lp__"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_lp___dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_0"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_0_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_tdd_5","b_tdd_9","b_tdd_14"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_td_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_w"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_w_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_h"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_h_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_X_td_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_dens_chains(fit,c("sigma_b_0_s","sigma_b_w_s","sigma_b_h_s","sigma_b_td_s","sigma_b_tdd_s","sigma_b_tdd_X_td_s"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_dens_chains.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_pairs(fit,c("b_tdd_5","b_tdd_9","b_tdd_14"))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_pairs.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_pairs(fit,pars = c("b_0","b_w","b_h","b_td","b_tdd_5","b_tdd_9","b_tdd_14","b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"),
off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_pairs_fixed.jpeg")),width=10,height=10)
rm(p)
})
try({
p <- mcmc_pairs(fit,pars = c("b_0","b_w","b_h","b_td"),
off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_pairs_noTDD_fixed.jpeg")),width=10,height=10)
rm(p)
})
try({
p <- mcmc_pairs(fit,pars = c("b_tdd_5","b_tdd_9","b_tdd_14","b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"),
off_diag_args = list(size = .5, alpha = 0.5))
ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_pairs_fixed.jpeg")),width=10,height=10)
rm(p)
})
try({
p <- mcmc_pairs(fit,regex_pars="sigma",
off_diag_args = list(size = .5, alpha = 0.5))
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_sigma_pairs.jpeg")),width=10,height=10)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_0_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_0_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_h_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_h_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_w_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_w_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_td_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_td_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_5_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_5_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_9_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_9_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_14_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_14_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_5_X_td_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_5_X_td_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_9_X_td_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_9_X_td_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit, regex_pars = "^b_tdd_14_X_td_s",prob=.5,prob_outer = .95)+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())+
labs(y="participant",x="estimate")
if(!debug_model) ggsave(p,filename=path(model_dir,glue("{prefix}_b_tdd_14_X_td_s.jpeg")),width=5,height=4)
rm(p)
})
try({
p <- mcmc_intervals(m_fit,pars=c("b_0","b_w","b_h","b_td","b_tdd_5","b_tdd_9","b_tdd_14",
"b_tdd_5_X_td","b_tdd_9_X_td","b_tdd_14_X_td"),prob=.5,prob_outer = .95)
rm(p)
})
source("/work/pi_alc_umass_edu/spconway/scratch/rect_2afc/analyses/analysis_for_paper.R", echo=TRUE)
b_0_s <- extract(fit,regex_pars="b_0_s")
b_0_s <- extract(fit,pars="b_0_s")
b_0_s$b_0_s
b_0_s <- extract(fit,pars="b_0_s")$b_0_s
dim(b_0_s)
rowSums(b_0_s)
hist(rowSums(b_0_s))
b_h_s <- extract(fit,pars="b_h_s")$b_h_s
hist(rowSums(b_h_s))
hist(rowSums(b_td_s))
b_td_s <- extract(fit,pars="b_td_s")$b_td_s
hist(rowSums(b_td_s))
b_w_s <- extract(fit,pars="b_w_s")$b_w_s
hist(rowSums(b_w_s))
b_tdd_5_s <- extract(fit,pars="b_tdd_5_s")$tdd_5_s
b_tdd_5_s <- extract(fit,pars="b_tdd_5_s")$tdd_5_s
hist(rowSums(b_tdd_5_s))
b_tdd_5_s <- extract(fit,pars="b_tdd_5_s")$tdd_5_s
b_tdd_5_s <- extract(fit,pars="b_tdd_5_s")$b_tdd_5_s
hist(rowSums(b_tdd_5_s))
b_tdd_9_s <- extract(fit,pars="b_tdd_9_s")$b_tdd_9_s
hist(rowSums(b_tdd_9_s))
b_tdd_9_s <- extract(fit,pars="b_tdd_9_s")$b_tdd_9_s
hist(rowSums(b_tdd_9_s))
b_tdd_14_s <- extract(fit,pars="b_tdd_14_s")$b_tdd_14_s
hist(rowSums(b_tdd_14_s))
b_tdd_5_X_td_s <- extract(fit,pars="b_tdd_5_X_td_s")$b_tdd_5_X_td_s
hist(rowSums(b_tdd_5_X_td_s))
b_tdd_9_X_td_s <- extract(fit,pars="b_tdd_9_X_td_s")$b_tdd_9_X_td_s
hist(rowSums(b_tdd_9_X_td_s))
b_tdd_14_X_td_s <- extract(fit,pars="b_tdd_14_X_td_s")$b_tdd_14_X_td_s
hist(rowSums(b_tdd_14_X_td_s))
mean(rowSums(b_0_s))
quantile(rowSums(b_0_s),probs=seq(0,1,.01))
quantile(rowSums(b_0_s),probs=seq(0,1,.1))
source("/work/pi_alc_umass_edu/spconway/scratch/rect_2afc/analyses/analysis_for_paper.R", echo=TRUE)
